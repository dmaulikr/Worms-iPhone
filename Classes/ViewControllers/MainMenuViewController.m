////  MainMenuViewController.m//  LateWorm////  Created by Susan Surapruik on 11/30/09.//  Copyright 2009 __MyCompanyName__. All rights reserved.//#import "MainMenuViewController.h"#import "LateWormAppDelegate.h"#import "TableViewController.h"#import "OpenALPlayer.h"#import "ProfileManager.h"@implementation MainMenuViewController@synthesize _navigationController, _rootViewController;/* // The designated initializer.  Override if you create the controller programmatically and want to perform customization that is not appropriate for viewDidLoad.- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {    if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {        // Custom initialization    }    return self;} */// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.- (void)viewDidLoad {	ProfileManager *profileManager = [ProfileManager sharedProfileManager];		unsigned i, totalFlowers;	    [super viewDidLoad];		self.view.userInteractionEnabled = NO;		totalFlowers = 0;		NSArray *levels = profileManager._levels;	NSDictionary *levelData;	for (i = 0; i < [levels count]; i++) {		levelData = [levels objectAtIndex:i];		if ([[levelData objectForKey:kGameDataFlowerKey] boolValue]) {			totalFlowers++;		}	}		_totalMoves.font = [UIFont fontWithName:@"HelveticaNeueLTStd-Hv" size:20.0];	_totalMoves.text = [NSString stringWithFormat:@"%d", totalFlowers];		// Create the navigation and view controllers	_rootViewController = [[TableViewController alloc] initWithStyle:UITableViewStylePlain];		UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:_rootViewController];	navigationController.navigationBarHidden = YES;	self._navigationController = navigationController;	[navigationController release];		// Configure and show the window	[_menuView addSubview:[_navigationController view]];		[self initializeViewAnimation];}- (void)didReceiveMemoryWarning {	// Releases the view if it doesn't have a superview.    [super didReceiveMemoryWarning];		// Release any cached data, images, etc that aren't in use.}- (void)viewDidUnload {	// Release any retained subviews of the main view.	// e.g. self.myOutlet = nil;}- (void)dealloc {	[_navigationController release];	[_rootViewController release];	[_totalMoves release];	[_menuView release];	    [super dealloc];}- (void) initializeViewAnimation {	[UIView beginAnimations:nil context:nil];	[UIView setAnimationDuration:kViewFadeTime];	[UIView setAnimationDelegate:self];	[UIView setAnimationDidStopSelector:@selector(viewVisible)];	self.view.alpha = 1.0;	[UIView commitAnimations];}- (void) viewVisible {	self.view.userInteractionEnabled = YES;}- (void) fadeView {	self.view.userInteractionEnabled = NO;		[UIView beginAnimations:nil context:nil];	[UIView setAnimationDuration:kViewFadeTime];	[UIView setAnimationDelegate:self];	[UIView setAnimationDidStopSelector:@selector(removeView)];	self.view.alpha = 0.0;	[UIView commitAnimations];}- (void) removeView {	if (_viewGarden) {		[[NSNotificationCenter defaultCenter] postNotificationName:kNOTIFICATION_CHANGESTATE object:self userInfo:[NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kGameState_Garden] forKey:kNOTIFICATION_CHANGESTATE]];	} else {		[[NSNotificationCenter defaultCenter] postNotificationName:kNOTIFICATION_CHANGESTATE object:self userInfo:[NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kGameState_Instructions] forKey:kNOTIFICATION_CHANGESTATE]];	}}- (IBAction) viewGarden {	[[NSNotificationCenter defaultCenter] postNotificationName:kNOTIFICATION_PLAYSOUND object:self userInfo:[NSDictionary dictionaryWithObjectsAndKeys:kAudioClick, kNOTIFICATION_PLAYSOUND, [NSNumber numberWithBool:YES], kNOTIFICATION_RESTART, nil]];		_viewGarden = YES;	[self fadeView];}@end